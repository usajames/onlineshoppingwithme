{% extends 'app/base.html' %}
{% load static %}
{% block title %}Checkout{% endblock title %}

{% block main-content %}
<div class="container my-5">
  <div class="row">

    <!-- Left Side: Address -->
    <div class="col-sm-6">
      <h4 class="mb-4">Select Shipping Address</h4>
      <form method="POST" action="{% url 'payment-done' %}">
        {% csrf_token %}
        <div class="mb-3">
          <label for="custid" class="form-label fw-bold">Choose Address</label>
          <select name="custid" class="form-select" required>
            {% for c in request.user.customer_set.all %}
            <option value="{{ c.id }}">
              {{ c.name }} - {{ c.locality }}, {{ c.city }}
            </option>
            {% endfor %}
          </select>
        </div>

        <!-- Payment Method -->
        <h4 class="mt-4 mb-3">Select Payment Method</h4>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="payment_method" id="debit" value="Debit Card" required>
          <label class="form-check-label fw-bold" for="debit">ðŸ’³ Debit Card</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="payment_method" id="jazzcash" value="JazzCash">
          <label class="form-check-label fw-bold" for="jazzcash">ðŸ“± JazzCash</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="payment_method" id="easypaisa" value="EasyPaisa">
          <label class="form-check-label fw-bold" for="easypaisa">ðŸ’¸ EasyPaisa</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="radio" name="payment_method" id="sadapay" value="SadaPay">
          <label class="form-check-label fw-bold" for="sadapay">ðŸ’° SadaPay</label>
        </div>

        <button type="submit" class="btn btn-primary mt-4">Place Order</button>
      </form>
    </div>

    <!-- Right Side: Order Summary -->
    <div class="col-sm-6">
      <h4 class="mb-4">Your Order Summary</h4>
      {% for item in request.user.cart_set.all %}
      <div class="card mb-3 p-3">
        <div class="row">
          <div class="col-sm-4">
            <img src="{{ item.product.product_image.url }}" class="img-fluid" alt="{{ item.product.title }}">
          </div>
          <div class="col-sm-8">
            <h5>{{ item.product.title }}</h5>
            <p>Qty: {{ item.quantity }}</p>
            <p class="fw-bold">Price: Rs. {{ item.product.discounted_price }}</p>
          </div>
        </div>
      </div>
      {% empty %}
      <p>No items in your cart.</p>
      {% endfor %}
    </div>

  </div>
</div>
{% endblock main-content %}
